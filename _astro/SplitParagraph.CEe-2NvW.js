import{i as a}from"./component-manager.modern.DSG18_2G.js";import{$ as h,t as n}from"./intersectionObserver.Bc8NuwfF.js";import{$ as c}from"./deviceStatus.BebISHRr.js";import{$ as d}from"./fonts.BORxYCOs.js";import{s as u}from"./split.DAnIehLJ.js";import"./index.3whys8t3.js";import"./index.K5Rn1T6c.js";import"./targets.Ch0TkwgG.js";import"./time.DWipCP5w.js";import"./timer.BnERl5BE.js";class i extends HTMLElement{static CONFIG={OBSERVER_OPTIONS:{shouldToggle:!0}};$content=null;$splitTextElements=[];splittedElements=[];hasPlayed=!1;eventUnsubscribers={onFonts:null,onIntersectionReady:null};connectedCallback(){this.initialize()}disconnectedCallback(){this.cleanup()}async initialize(){requestAnimationFrame(()=>{this.setupDomElements(),this.bindEvents()})}setupDomElements(){if(this.$content=this.children,!this.$content||this.$content.length===0){console.warn("SplitParagraph: Missing required DOM elements");return}this.$splitTextElements=Array.from(this.$content).filter(t=>t instanceof HTMLElement)}bindEvents(){this.eventUnsubscribers.onFonts=d.subscribe(this.handleFontsLoaded),this.eventUnsubscribers.onIntersectionReady=h.subscribe(this.handleIntersectionReady)}unbindEvents(){Object.values(this.eventUnsubscribers).forEach(t=>{t?.()})}handleIntersectionReady=t=>{t&&this.setupIntersectionObserver()};setupIntersectionObserver(){n.observe(this,this.handleIntersection,i.CONFIG.OBSERVER_OPTIONS)}handleIntersection=(t,r)=>{r&&!c.get().isReducedMotion&&this.play()};handleFontsLoaded=t=>{t.isLoaded&&(this.eventUnsubscribers.onFonts?.(),this.eventUnsubscribers.onFonts=null,this.setupSplitText())};setupSplitText(){this.$splitTextElements.length!==0&&this.$splitTextElements.forEach(t=>{u(t,{words:!1,chars:!1,lines:{wrap:!0}}).addEffect(e=>(e.$target.querySelectorAll("[data-line]").forEach(s=>{const o=s.getAttribute("data-line")||"0";s.style.setProperty("--line-index",o);const l=s.parentElement;l&&(l.style.overflow="")}),this.splittedElements.push(e),()=>{}))})}play(){!this.$content||this.hasPlayed||(this.hasPlayed=!0,this.classList.add("is-inview"),n.unobserve(this))}cleanup(){n.unobserve(this),this.splittedElements.forEach(t=>{typeof t.revert=="function"&&t.revert()}),this.splittedElements=[],this.$content=null,this.$splitTextElements=[],this.hasPlayed=!1,this.unbindEvents()}}customElements.define("c-split-paragraph",a(i,"SplitParagraph"));export{i as SplitParagraph};
