import{i as m}from"./component-manager.modern.DSG18_2G.js";import{T as n,a as h}from"./TweenText.TXf6yKp6.js";import{a as l,b as d}from"./deviceStatus.BebISHRr.js";import{c as p}from"./timeline.0vhVXiXF.js";import{s as y}from"./split.DAnIehLJ.js";import{o as c}from"./scroll.Dtselkni.js";import{a as w}from"./animation.CYjtRj_b.js";import{e as g}from"./parser.BX5Tv8gU.js";import"./index.3whys8t3.js";import"./convert.BAjTBXIu.js";import"./target.z-VVwDyG.js";import"./targets.Ch0TkwgG.js";import"./timer.BnERl5BE.js";import"./index.D7RipQER.js";import"./stagger.B2p9fBMh.js";import"./position.DOXOWIVY.js";import"./index.K5Rn1T6c.js";import"./time.DWipCP5w.js";class i extends HTMLElement{static DEFAULT_DURATION=550;static DEFAULT_EASE=g.outExpo;$splitTextElements;$tweenMedias;$tweenWrapper;$cartography;masterTimeline=p({autoplay:!1});isCartographyReady=!1;constructor(){super()}init(){this.$cartography=this.querySelector("[data-triptych-cartography]");const{isMobile:r}=l.get(),{isSafari:a}=d.get();if(a||r){const t=this.querySelector("[data-tween-dashed-cartography]");t.style.opacity="0.35",t.querySelectorAll("path[stroke-dasharray]").forEach(e=>{e.removeAttribute("stroke-dasharray")})}this.$splitTextElements=Array.from(this.querySelectorAll("[data-split-text]")),this.$splitTextElements.forEach(t=>{y(t,{words:!1,chars:!1,lines:{wrap:!0}}).addEffect(e=>{e.lines.forEach(o=>{Object.assign(o.style,{paddingBottom:"0.15em",paddingRight:"0.15em",position:"relative",marginTop:"-0.15em",whiteSpace:"nowrap"})});const s=p({autoplay:c({target:t,enter:"bottom top-=100",leave:"top bottom",sync:.25})}).sync(n.animate(e.lines,{duration:i.DEFAULT_DURATION}),0);return this.masterTimeline.sync(s,0),s})}),this.$tweenWrapper=this.querySelector("[data-tween-text-wrapper]"),this.masterTimeline.sync(w(this.$tweenWrapper,{autoplay:c({enter:"bottom top-=200",leave:"top top+=20%",sync:.5}),scale:["0.1","1"],ease:i.DEFAULT_EASE}),0),this.$tweenMedias=Array.from(this.querySelectorAll("[data-tween-media]")),this.$tweenMedias.forEach(t=>{const e=t.querySelector("[c-caption-media-cover]"),s=t.querySelector("[c-caption-media-caption] p");h.initTween(e),n.initTween(s);const o=p({autoplay:c({target:t,enter:"bottom bottom",leave:"top top",sync:"play"})}).sync(h.animate(e,{duration:i.DEFAULT_DURATION}),0).sync(n.animate(s,{duration:i.DEFAULT_DURATION}),0);this.masterTimeline.sync(o,0)})}connectedCallback(){this.init(),this.bindEvents(),this.$cartography&&customElements.whenDefined("c-cartography").then(()=>{this.isCartographyReady=!0,this.classList.contains("is-inview")&&this.$cartography.show()})}disconnectedCallback(){this.unbindEvents()}bindEvents(){window.addEventListener("triptych:inview",this.inviewHandler),window.addEventListener("triptych:progress",this.onProgress)}unbindEvents(){window.removeEventListener("triptych:inview",this.inviewHandler),window.removeEventListener("triptych:progress",this.onProgress)}inviewHandler=r=>{const a=r.detail,{target:t,way:e}=a;t===this&&(e==="enter"?this.isCartographyReady&&this.$cartography.show():(this.isCartographyReady&&this.$cartography.hide(),this.masterTimeline.reset()))};onProgress=r=>{const a=r.detail,{target:t,progress:e}=a;t===this&&this.isCartographyReady&&(this.$cartography.progress=e)}}customElements.define("c-triptych",m(i,"Triptych"));export{i as Triptych};
