let s;async function u(t){const{action:o,story:n}=t||{};if(o==="input"&&n){const r=async()=>{a("storyblok-live-preview-updating",{story:n});const e=await b(n),i=document.body;if(e.outerHTML===i.outerHTML)return;const d=document.querySelector('[data-blok-focused="true"]');y(i,e,d),a("storyblok-live-preview-updated",{story:n})};clearTimeout(s),s=setTimeout(r,500)}["published","change"].includes(t?.action)&&location.reload()}function y(t,o,n){if(n){const r=n.getAttribute("data-blok-uid"),e=o.querySelector(`[data-blok-uid="${r}"]`);e&&(e.setAttribute("data-blok-focused","true"),n.replaceWith(e))}else t.replaceWith(o)}async function b(t){const o=await(await fetch(location.href,{method:"POST",body:JSON.stringify({...t,is_storyblok_preview:!0}),headers:{"Content-Type":"application/json"}})).text();return new DOMParser().parseFromString(o,"text/html").body}function a(t,o){document.dispatchEvent(new CustomEvent(t,{detail:o}))}let c=!1;const l=[],p=t=>new Promise((o,n)=>{if(typeof window>"u"){n(new Error("Cannot load Storyblok bridge: window is undefined (server-side environment)"));return}if(window.storyblokRegisterEvent=e=>{if(!window.location.search.includes("_storyblok")){console.warn("You are not in Draft Mode or in the Visual Editor.");return}c?e():l.push(e)},document.getElementById("storyblok-javascript-bridge")){o(void 0);return}const r=document.createElement("script");r.async=!0,r.src=t,r.id="storyblok-javascript-bridge",r.onerror=e=>n(e),r.onload=e=>{l.forEach(i=>i()),c=!0,o(e)},document.getElementsByTagName("head")[0].appendChild(r)});let w="https://app.storyblok.com/f/storyblok-v2-latest.js";const f=()=>p(w);f().then(()=>{const{StoryblokBridge:t}=window;new t().on(["published","change","input"],u)});
