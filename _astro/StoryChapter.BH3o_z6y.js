import{i as d}from"./component-manager.modern.DSG18_2G.js";import{a as r,T as o}from"./TweenText.TXf6yKp6.js";import{f as m}from"./convert.BAjTBXIu.js";import{s as y}from"./index.D7RipQER.js";import{a as u}from"./index.3whys8t3.js";import{s as c}from"./split.DAnIehLJ.js";import{c as p}from"./timeline.0vhVXiXF.js";import{s as l}from"./stagger.B2p9fBMh.js";import{e as f}from"./parser.BX5Tv8gU.js";import"./target.z-VVwDyG.js";import"./targets.Ch0TkwgG.js";import"./timer.BnERl5BE.js";import"./animation.CYjtRj_b.js";import"./scroll.Dtselkni.js";import"./time.DWipCP5w.js";import"./position.DOXOWIVY.js";class n extends HTMLElement{static DEFAULT_EASE=f.outExpo;static BOUNCE_EASE=t=>y({bounce:.214,duration:t});static DEFAULT_DURATION=700;$tweenMedias;$taglineSplit;$labelSplit;$textSplit;isActive=u(!1);chapterIndex;timeline;_unsubActiveState;constructor(){super(),this.chapterIndex=m(this.getAttribute("data-chapter-index"),0),this.$tweenMedias=Array.from(this.querySelectorAll("[data-tween-media]")),this.$tweenMedias.length&&r.initTween(this.$tweenMedias,{opacity:"1"});const t=this.querySelector("[data-story-chapter-tagline]"),a=this.querySelector("[data-story-chapter-label]"),e=this.querySelector("[data-story-chapter-text]"),i={words:!1,chars:!1,lines:{wrap:!0}};this.$taglineSplit=c(t,i),this.$taglineSplit.addEffect(({lines:s})=>(o.applyLineStylesForSplitHeading(s),()=>{})),this.$labelSplit=c(a,i),this.$textSplit=c(e,i),this.chapterIndex>0&&(this.style.opacity="0",this.style.pointerEvents="none",this.style.touchAction="none")}connectedCallback(){this.bindEvents()}disconnectedCallback(){this.unbindEvents()}bindEvents(){this._unsubActiveState=this.isActive.subscribe(this.handleActiveState)}unbindEvents(){this._unsubActiveState?.()}handleActiveState=t=>{this.style.pointerEvents=t?"all":"none",this.style.touchAction=t?"auto":"none",this.setAttribute("data-chapter-hidden",t?"false":"true")};getTextLines(){return{tagline:this.$taglineSplit.lines,label:this.$labelSplit.lines,text:this.$textSplit.lines}}show(t=!1,a=!1){if(this.isActive.get()&&!a)return;this.isActive.set(!0);const e=t?0:n.DEFAULT_DURATION,{tagline:i,label:s,text:h}=this.getTextLines();return this.timeline?.cancel(),this.timeline=p({autoplay:!1,delay:100,onBegin:()=>{this.isActive.get()&&(this.style.opacity="1",this.style.pointerEvents="all",this.style.touchAction="auto")}}),i.length&&this.timeline.sync(o.revealTween(i,{delay:l(50),duration:e,ease:n.DEFAULT_EASE}),0),s.length&&h.length&&this.timeline.sync(o.revealTween([...s,...h],{delay:l(50),duration:e}),0),this.$tweenMedias.length&&this.timeline.sync(r.revealTween(this.$tweenMedias,{delay:l(100),duration:e}),0),this.timeline.play()}hide(t=!1,a=!1){if(!this.isActive.get()&&!a)return;this.isActive.set(!1);const e=t?0:n.DEFAULT_DURATION,{tagline:i,label:s,text:h}=this.getTextLines();return this.timeline?.cancel(),this.timeline=p({autoplay:!1,onComplete:()=>{this.isActive.get()||(this.style.opacity="0",this.style.pointerEvents="none",this.style.touchAction="none")}}),i.length&&this.timeline.sync(o.hideTween(i,{delay:l(50),duration:e,ease:n.DEFAULT_EASE}),0),s.length&&h.length&&this.timeline.sync(o.hideTween([...s,...h],{delay:l(50),duration:e,ease:n.DEFAULT_EASE}),0),this.$tweenMedias.length&&this.timeline.sync(r.hideTween(this.$tweenMedias,{delay:l(100),duration:e}),0),this.timeline.play()}}customElements.define("c-story-chapter",d(n,"StoryChapter"));export{n as StoryChapter};
