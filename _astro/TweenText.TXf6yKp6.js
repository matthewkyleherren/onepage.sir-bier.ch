import{f}from"./convert.BAjTBXIu.js";import{s as h}from"./target.z-VVwDyG.js";import{c as S}from"./timeline.0vhVXiXF.js";import{o as p}from"./scroll.Dtselkni.js";import{a as c}from"./animation.CYjtRj_b.js";import{e as R}from"./parser.BX5Tv8gU.js";import{s as I}from"./index.D7RipQER.js";import{s as L}from"./split.DAnIehLJ.js";import{s as v}from"./stagger.B2p9fBMh.js";const W=l=>new Promise(e=>setTimeout(e,l)),D=(l=0)=>l>0?new Promise(e=>setTimeout(()=>{D(l-1).then(e)},0)):new Promise(e=>setTimeout(e,0)),U=(l,e)=>{let t=null;const r=(...i)=>{t&&clearTimeout(t),t=setTimeout(()=>l(...i),e)};return r.cancel=()=>{t&&(clearTimeout(t),t=null)},r};class s{static DEFAULT_DURATION=800;static DEFAULT_EASE=R.outExpo;static ITEM_STAGGER=100;static GATHER_DEBOUNCE=50;static CLIP_FROM="inset(100% 0% 0% 0% round calc(var(--spacing) * 4))";static CLIP_TO="inset(0% 0% 0% 0% round calc(var(--spacing) * 4))";static CLIP_NONE="inset(0% 0% 0% 0% round calc(var(--spacing) * 0))";static $tweenBlockElements=[];static $tweenWrappers=[];static observer=null;static processedElements=new WeakSet;static debouncedGather=U(()=>s.gather(),s.GATHER_DEBOUNCE);static init(){D(100).then(()=>{this.gather(),this.setupObserver()})}static destroy(){this.observer&&(this.observer.disconnect(),this.observer=null),this.debouncedGather.cancel()}static setupObserver(){this.destroy(),this.observer=new MutationObserver(e=>{e.some(r=>r.type!=="childList"?!1:Array.from(r.addedNodes).some(i=>{if(i.nodeType!==Node.ELEMENT_NODE)return!1;const o=i;return o.hasAttribute?.("data-tweenblock")||o.hasAttribute?.("data-tweenblock-wrapper")||o.querySelector?.("[data-tweenblock], [data-tweenblock-wrapper]")}))&&this.debouncedGather()}),this.observer.observe(document.body,{childList:!0,subtree:!0})}static getOffsetValue(e){return e.getAttribute("data-tweenblock-offset")??""}static getStaggerValue(e){return f(e.getAttribute("data-tweenblock-stagger"),s.ITEM_STAGGER)}static getEaseValue(e){return e.getAttribute("data-tweenblock-ease")??s.DEFAULT_EASE}static getDurationValue(e){return f(e.getAttribute("data-tweenblock-duration"),s.DEFAULT_DURATION)}static buildEnterString(e){return e===void 0?"bottom bottom":`bottom bottom${e}`}static gather(){s.$tweenWrappers=Array.from(document.querySelectorAll("[data-tweenblock-wrapper]")),s.$tweenWrappers.forEach(t=>{if(!t.isConnected||!t.parentElement||this.processedElements.has(t))return;const r=Array.from(t.querySelectorAll("[data-tweenblock-item]"));if(r.length===0)return;const i=s.getOffsetValue(t),o=s.getStaggerValue(t);r.forEach(n=>{h(n,{scale:"0",skewX:"12deg",skewY:"10deg",opacity:"0",clipPath:s.CLIP_FROM}),this.processedElements.add(n)});const E=S({autoplay:p({target:t,enter:s.buildEnterString(i),leave:"top top",sync:"play"})});r.forEach((n,d)=>{const u=s.getDurationValue(n),g=s.getEaseValue(n),m=c(n,{scale:["0","1"],skewX:["12deg","0deg"],skewY:["10deg","0deg"],opacity:["0","1"],clipPath:[s.CLIP_FROM,s.CLIP_TO],duration:u,ease:g});E.sync(m,d*o)}),this.processedElements.add(t)});const e=new Set;s.$tweenWrappers.forEach(t=>{Array.from(t.querySelectorAll("[data-tweenblock-item]")).forEach(i=>e.add(i))}),s.$tweenBlockElements=Array.from(document.querySelectorAll("[data-tweenblock]")),s.$tweenBlockElements.forEach(t=>{if(e.has(t)||!t.isConnected||!t.parentElement||this.processedElements.has(t))return;const r=s.getOffsetValue(t),i=s.getDurationValue(t),o=s.getEaseValue(t);h(t,{scale:"0",skewX:"12deg",skewY:"10deg",opacity:"0",clipPath:s.CLIP_FROM}),c(t,{scale:["0","1"],skewX:["12deg","0deg"],skewY:["10deg","0deg"],opacity:["0","1"],clipPath:[s.CLIP_FROM,s.CLIP_TO],duration:i,ease:o,autoplay:p({target:t,enter:s.buildEnterString(r),leave:"top top",sync:"play"})}),this.processedElements.add(t)})}static show=e=>{const t=e,{target:r}=t.detail;c(r,{scale:"1",skewX:"0deg",skewY:"0deg",opacity:"1",clipPath:s.CLIP_TO,duration:s.DEFAULT_DURATION,ease:s.DEFAULT_EASE})};static hide=e=>{const t=e,{target:r}=t.detail;c(r,{scale:"0",skewX:"12deg",skewY:"10deg",opacity:"0",clipPath:s.CLIP_FROM,duration:s.DEFAULT_DURATION,ease:s.DEFAULT_EASE})};static animate=(e,t)=>c(e,{scale:["0","1"],skewX:["12deg","0deg"],skewY:["10deg","0deg"],opacity:["0","1"],clipPath:[s.CLIP_FROM,s.CLIP_TO],duration:s.DEFAULT_DURATION,ease:s.DEFAULT_EASE,autoplay:!1,...t});static revealTween=s.animate;static hideTween=(e,t)=>c(e,{scale:"0",skewX:"12deg",skewY:"10deg",opacity:"0",clipPath:s.CLIP_FROM,duration:s.DEFAULT_DURATION,ease:s.DEFAULT_EASE,...t});static initTween=(e,t)=>h(e,{scale:"0",skewX:"12deg",skewY:"10deg",opacity:"0",clipPath:s.CLIP_FROM,...t})}class a{static DEFAULT_DURATION=700;static DEFAULT_EASE=I({bounce:.214,duration:a.DEFAULT_DURATION});static ITEM_STAGGER=100;static GATHER_DEBOUNCE=50;static $tweenTextElements=[];static $tweenSplitTextElements=[];static $tweenWrappers=[];static observer=null;static processedElements=new WeakSet;static debouncedGather=U(()=>a.gather(),a.GATHER_DEBOUNCE);static init(){D(100).then(()=>{this.gather(),this.setupObserver()})}static destroy(){this.observer&&(this.observer.disconnect(),this.observer=null),this.debouncedGather.cancel()}static setupObserver(){this.destroy(),this.observer=new MutationObserver(e=>{e.some(r=>r.type!=="childList"?!1:Array.from(r.addedNodes).some(i=>{if(i.nodeType!==Node.ELEMENT_NODE)return!1;const o=i;return o.hasAttribute?.("data-tweentext")||o.hasAttribute?.("data-tweentext-wrapper")||o.hasAttribute?.("data-tweentext-split")||o.querySelector?.("[data-tweentext], [data-tweentext-wrapper], [data-tweentext-split]")}))&&this.debouncedGather()}),this.observer.observe(document.body,{childList:!0,subtree:!0})}static getOffsetValue(e){return e.getAttribute("data-tweentext-offset")??""}static getStaggerValue(e){return f(e.getAttribute("data-tweentext-stagger"),a.ITEM_STAGGER)}static getEaseValue(e){return e.getAttribute("data-tweentext-ease")??a.DEFAULT_EASE}static getDurationValue(e){return f(e.getAttribute("data-tweentext-duration"),a.DEFAULT_DURATION)}static buildEnterString(e){return e===void 0?"bottom bottom":`bottom bottom${e}`}static gather(){a.$tweenWrappers=Array.from(document.querySelectorAll("[data-tweentext-wrapper]")),a.$tweenWrappers.forEach(t=>{if(!t.isConnected||!t.parentElement||this.processedElements.has(t))return;const r=Array.from(t.querySelectorAll("[data-tweentext-item]"));if(r.length===0)return;const i=a.getOffsetValue(t),o=a.getStaggerValue(t),E=S({autoplay:p({target:t,enter:a.buildEnterString(i),leave:"top top",sync:"play"})});r.forEach((n,d)=>{if(!n.isConnected)return;const u=n.hasAttribute("data-tweentext-split"),g=a.getDurationValue(n),m=a.getEaseValue(n);if(u){const A=n.hasAttribute("data-tweentext-split-no-accessible"),F=n.hasAttribute("data-tweentext-is-heading"),y=L(n,{words:!1,chars:!1,lines:!0,accessible:!A});F&&y.addEffect(b=>(n.style.position="relative",n.style.paddingTop=".2em",n.style.marginBottom="-.2em",a.applyLineStylesForSplitHeading(b.lines),()=>{})),y.addEffect(b=>{const O=S().sync(c(b.lines,{y:["100%","0%"],skewX:["10deg","0deg"],scale:["1.04","1"],opacity:["0","1"],duration:g,ease:m,delay:v(o),onComplete:()=>{y.resizeObserver.disconnect()}}),0);return E.sync(O,d),O})}else{const A=c(n,{y:["100%","0%"],skewX:["10deg","0deg"],scale:["1.04","1"],opacity:["0","1"],duration:g,ease:m});E.sync(A,d*o)}this.processedElements.add(n)}),this.processedElements.add(t)});const e=new Set;a.$tweenWrappers.forEach(t=>{Array.from(t.querySelectorAll("[data-tweentext-item]")).forEach(i=>e.add(i))}),a.$tweenSplitTextElements=Array.from(document.querySelectorAll("[data-tweentext-split]")),a.$tweenSplitTextElements.forEach(t=>{if(e.has(t)||!t.isConnected||!t.parentElement||this.processedElements.has(t))return;const r=a.getOffsetValue(t),i=a.getDurationValue(t),o=a.getEaseValue(t),E=t.hasAttribute("data-tweentext-split-no-accessible"),n=t.hasAttribute("data-tweentext-is-heading"),d=L(t,{words:!1,chars:!1,lines:!0,accessible:!E});n&&d.addEffect(u=>(t.style.position="relative",t.style.paddingTop=".2em",t.style.marginBottom="-.2em",a.applyLineStylesForSplitHeading(u.lines),()=>{})),d.addEffect(u=>c(u.lines,{y:["100%","0%"],skewX:["10deg","0deg"],scale:["1.04","1"],opacity:["0","1"],duration:i,ease:o,delay:v(50),onComplete:()=>{d.resizeObserver.disconnect()},autoplay:p({target:t,enter:a.buildEnterString(r),leave:"top top",sync:"play"})})),this.processedElements.add(t)}),a.$tweenTextElements=Array.from(document.querySelectorAll("[data-tweentext]")),a.$tweenTextElements.forEach(t=>{if(e.has(t)||t.hasAttribute("data-tweentext-split")||!t.isConnected||!t.parentElement||this.processedElements.has(t))return;const r=a.getOffsetValue(t),i=a.getDurationValue(t),o=a.getEaseValue(t);c(t,{y:["100%","0%"],skewX:["10deg","0deg"],scale:["1.04","1"],opacity:["0","1"],duration:i,ease:o,autoplay:p({target:t,enter:a.buildEnterString(r),leave:"top top",sync:"play"})}),this.processedElements.add(t)})}static show=e=>{const t=e,{target:r}=t.detail;c(r,{y:"0%",skewX:"0deg",scale:"1",opacity:1,duration:a.DEFAULT_DURATION,ease:a.DEFAULT_EASE})};static hide=e=>{const t=e,{target:r}=t.detail;c(r,{y:"100%",skewX:"10deg",scale:"1.04",opacity:0,duration:a.DEFAULT_DURATION,ease:a.DEFAULT_EASE})};static animate=(e,t)=>c(e,{y:["100%","0%"],skewX:["10deg","0deg"],scale:["1.04","1"],opacity:["0","1"],duration:a.DEFAULT_DURATION,ease:a.DEFAULT_EASE,autoplay:!1,...t});static initTween=(e,t)=>h(e,{y:"100%",skewX:"10deg",scale:"1.04",opacity:"0",...t});static revealTween=a.animate;static hideTween=(e,t)=>c(e,{y:["0%","-104%"],skewX:["0deg","-12deg"],scale:["1",".96"],opacity:".2",duration:a.DEFAULT_DURATION,ease:a.DEFAULT_EASE,autoplay:!1,...t});static applyLineStylesForSplitHeading=(e,t)=>{e.forEach(r=>{Object.assign(r.style,{paddingBottom:".2em",position:"relative",marginTop:"-.2em",whiteSpace:"nowrap",...t??{}})})}}export{a as T,s as a,W as w};
